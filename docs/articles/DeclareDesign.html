<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Graeme Blair, Jasper Cooper, Alexander Coppock, and Macartan Humphreys" />

<meta name="date" content="2017-07-30" />

<title>Diagnosing Research Designs with DeclareDesign</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Diagnosing Research Designs with DeclareDesign</h1>
<h4 class="author"><em>Graeme Blair, Jasper Cooper, Alexander Coppock, and Macartan Humphreys</em></h4>
<h4 class="date"><em>2017-07-30</em></h4>



<div id="overview" class="section level1">
<h1>Overview</h1>
<p>The <code>DeclareDesign</code> package has only about 10 functions.</p>
<p>The core functions represent key steps in a research design, some of which may be used more than once, such as if you have two random assignment steps or multiple estimators.</p>
<ol style="list-style-type: decimal">
<li><code>declare_population</code></li>
<li><code>declare_potential_outcomes</code></li>
<li><code>declare_sampling</code></li>
<li><code>declare_assignment</code></li>
<li><code>declare_estimand</code></li>
<li><code>declare_estimator</code></li>
</ol>
<p>The function <code>declare_design</code> can take any of these six functions, plus any R function that takes data and returns data.</p>
<p>The post-design-declaration commands are:</p>
<ol style="list-style-type: decimal">
<li><code>modify_design</code> (takes a design and a set of modifications, returns a design)</li>
<li><code>diagnose_design</code> (takes a design, returns simulations and diagnosis)</li>
<li><code>compare_designs</code> (takes a list of designs and diagnoses them all)</li>
<li><code>draw_data</code> (takes a design and returns a single draw of the data)</li>
<li><code>get_estimates</code>(takes a design a returns a single simulation of estimates)</li>
<li><code>get_estimands</code>(takes a design a returns a single simulation of estimands)</li>
</ol>
<p>There are a few other features:</p>
<ol style="list-style-type: decimal">
<li>A template is a function that takes parameters (e.g., <code>N</code>) and returns a design. <code>quick_design</code> is a function of a template and parameters that returns a design.</li>
<li>We can easily <code>declare_diagnosands</code>, which are things like power and bias, but the package defaults to the usual suspects.</li>
<li><code>reveal_outcomes</code> implements a general switching equation, which allows you to reveal outcomes from potential outcomes and a treatment assignment.</li>
</ol>
</div>
<div id="the-six-steps" class="section level1">
<h1>The Six Steps</h1>
<p>Each of the <code>declare_*</code> functions returns a <strong>function</strong>.</p>
<p>In addition to using them to declare the design, you can just run them yourself, i.e. <code>your_potential_outcomes(your_population())</code>.</p>
<div id="population" class="section level2">
<h2>Population</h2>
<p>You can easily define a single-level population (i.e. just individuals). You can use any R function to create a variable, with <code>N</code> being the only privileged name. The output is a function, so calling <code>my_population()</code> makes a data.frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_population &lt;-
<span class="st">  </span><span class="kw">declare_population</span>(<span class="dt">N =</span> <span class="dv">1000</span>,
  <span class="dt">income =</span> <span class="kw">rnorm</span>(N),
  <span class="dt">age =</span> <span class="kw">sample</span>(<span class="dv">18</span>:<span class="dv">95</span>, N, <span class="dt">replace =</span> T))

pop &lt;-<span class="st"> </span><span class="kw">my_population</span>()
<span class="kw">head</span>(pop)</code></pre></div>
<pre><code>##     ID     income age
## 1 0001  1.3709584  95
## 2 0002 -0.5646982  52
## 3 0003  0.3631284  72
## 4 0004  0.6328626  87
## 5 0005  0.4042683  83
## 6 0006 -0.1061245  75</code></pre>
<p>Multi-level datasets are also easy to use. You set the <code>N</code> of each level in a call to <code>level()</code>. The <code>level</code> function is neat – if the previous level has data, it merges so that there are N entries for each of the units at the higher level. We can handle non-fixed number of units at each level too. In the <code>individuals</code> line, we’ve drawn a random number of individuals that are in each village.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_population_nested &lt;-<span class="st"> </span><span class="kw">declare_population</span>(
  <span class="dt">districts =</span> <span class="kw">level</span>(<span class="dt">N =</span> <span class="dv">25</span>, <span class="dt">urban =</span> <span class="kw">sample</span>(<span class="dv">0</span>:<span class="dv">1</span>, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>)),
  <span class="dt">villages =</span> <span class="kw">level</span>(<span class="dt">N =</span> <span class="dv">10</span>, <span class="dt">altitude =</span> <span class="kw">rnorm</span>(N)),
  <span class="dt">individuals =</span> <span class="kw">level</span>(<span class="dt">N =</span> <span class="kw">sample</span>(<span class="dv">100</span>:<span class="dv">200</span>, <span class="dt">size =</span> <span class="dv">250</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>), 
                      <span class="dt">income =</span> <span class="kw">rnorm</span>(N),
                      <span class="dt">age =</span> <span class="kw">sample</span>(<span class="dv">18</span>:<span class="dv">95</span>, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>)))</code></pre></div>
<p>This says that there are 25 districts, 10 villages per districts, and then between 100 and 200 individuals per village. It creates districts first, then merges in villages, then merges in individuals using ID variables created at the level above it.</p>
<p>Within those levels, you can easily include existing data (and also add variables to them if you wish):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">region_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">capital =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))
pop_level_data &lt;-<span class="st"> </span><span class="kw">declare_population</span>(
  <span class="dt">regions =</span> <span class="kw">level</span>(<span class="dt">level_data =</span> region_data, <span class="dt">gdp =</span> <span class="kw">runif</span>(<span class="dv">5</span>)),
  <span class="dt">cities =</span> <span class="kw">level</span>(<span class="dt">N =</span> <span class="dv">2</span>, <span class="dt">subways =</span> <span class="kw">rnorm</span>(N, <span class="dt">mean =</span> <span class="dv">5</span>)))

<span class="kw">head</span>(<span class="kw">pop_level_data</span>())</code></pre></div>
<pre><code>##   capital regions       gdp cities  subways
## 1       1       1 0.2737925     01 5.504524
## 2       1       1 0.2737925     02 5.750711
## 3       0       2 0.9441967     03 4.171185
## 4       0       2 0.9441967     04 5.709549
## 5       0       3 0.4459833     05 5.949915
## 6       0       3 0.4459833     06 4.421144</code></pre>
<p>Similarly, you can easily declare your existing data as the population:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">country_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">cow_code =</span> <span class="kw">c</span>(<span class="dv">504</span>, <span class="dv">15</span>, <span class="dv">100</span>, <span class="dv">90</span>),
  <span class="dt">polity_iv =</span> <span class="kw">c</span>(-<span class="dv">9</span>, <span class="dv">7</span>, -<span class="dv">1</span>, <span class="dv">3</span>))
pop_data &lt;-<span class="st"> </span><span class="kw">declare_population</span>(<span class="dt">data =</span> country_data)

<span class="kw">head</span>(<span class="kw">pop_data</span>())</code></pre></div>
<pre><code>##   cow_code polity_iv ID
## 1      504        -9  1
## 2       15         7  2
## 3      100        -1  3
## 4       90         3  4</code></pre>
<p>If you don’t want your data to be fixed, you can resample from it, i.e.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pop_data_bootstrap &lt;-<span class="st"> </span><span class="kw">declare_population</span>(
  <span class="dt">data =</span> country_data, <span class="dt">population_function =</span> fabricatr::resample_data)

<span class="kw">head</span>(<span class="kw">pop_data_bootstrap</span>())</code></pre></div>
<pre><code>##   cow_code polity_iv
## 1      504        -9
## 2       90         3
## 3       90         3
## 4       15         7</code></pre>
<p>Note that <code>fabricatr</code> is one of the helper packages that come along with <code>DeclareDesign</code>. <code>fabricatr</code> helps you simulate population data or resample from existing data.</p>
</div>
<div id="potential-outcomes" class="section level2">
<h2>Potential outcomes</h2>
<p>A <code>declare_potential_outcomes</code> declaration returns a function. That function takes data and returns data with potential outcomes columns appended. There are two ways of declaring potential outcomes: a formula or as separate variables (as in <code>declare_population</code>).</p>
<div id="in-a-formula" class="section level3">
<h3>In a formula</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_potential_outcomes &lt;-<span class="st"> </span><span class="kw">declare_potential_outcomes</span>(
  <span class="dt">formula =</span> Y ~<span class="st"> </span>.<span class="dv">25</span> *<span class="st"> </span>Z +<span class="st"> </span>.<span class="dv">01</span> *<span class="st"> </span>age *<span class="st"> </span>Z)
pop_pos &lt;-<span class="st"> </span><span class="kw">my_potential_outcomes</span>(pop)
<span class="kw">head</span>(pop_pos)</code></pre></div>
<pre><code>##     ID     income age Y_Z_0 Y_Z_1
## 1 0001  1.3709584  95     0  1.20
## 2 0002 -0.5646982  52     0  0.77
## 3 0003  0.3631284  72     0  0.97
## 4 0004  0.6328626  87     0  1.12
## 5 0005  0.4042683  83     0  1.08
## 6 0006 -0.1061245  75     0  1.00</code></pre>
<p>This has defaults set for condition_names (0, 1) and the assignment variable name (Z). You can set the “domain” of the potential outcomes function with <code>condition_names</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_potential_outcomes &lt;-<span class="st"> </span><span class="kw">declare_potential_outcomes</span>(
  <span class="dt">formula =</span> Y ~<span class="st"> </span>.<span class="dv">25</span> *<span class="st"> </span>Z +<span class="st"> </span>.<span class="dv">01</span> *<span class="st"> </span>age *<span class="st"> </span>Z,
  <span class="dt">condition_names =</span> <span class="dv">1</span>:<span class="dv">4</span>)
<span class="kw">head</span>(<span class="kw">my_potential_outcomes</span>(pop))</code></pre></div>
<pre><code>##     ID     income age Y_Z_1 Y_Z_2 Y_Z_3 Y_Z_4
## 1 0001  1.3709584  95  1.20  2.40  3.60  4.80
## 2 0002 -0.5646982  52  0.77  1.54  2.31  3.08
## 3 0003  0.3631284  72  0.97  1.94  2.91  3.88
## 4 0004  0.6328626  87  1.12  2.24  3.36  4.48
## 5 0005  0.4042683  83  1.08  2.16  3.24  4.32
## 6 0006 -0.1061245  75  1.00  2.00  3.00  4.00</code></pre>
</div>
<div id="as-separate-variables" class="section level3">
<h3>As separate variables</h3>
<p>The second way, which some may prefer, is to define each potential outcome yourself. This bakes in the condition names and assignment variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_potential_outcomes &lt;-
<span class="st">  </span><span class="kw">declare_potential_outcomes</span>(
    <span class="dt">Y_Z_0 =</span> .<span class="dv">05</span>,
    <span class="dt">Y_Z_1 =</span> .<span class="dv">30</span> +<span class="st"> </span>.<span class="dv">01</span> *<span class="st"> </span>age)

<span class="kw">head</span>(<span class="kw">my_potential_outcomes</span>(pop))</code></pre></div>
<pre><code>##     ID     income age Y_Z_0 Y_Z_1
## 1 0001  1.3709584  95  0.05  1.25
## 2 0002 -0.5646982  52  0.05  0.82
## 3 0003  0.3631284  72  0.05  1.02
## 4 0004  0.6328626  87  0.05  1.17
## 5 0005  0.4042683  83  0.05  1.13
## 6 0006 -0.1061245  75  0.05  1.05</code></pre>
</div>
</div>
<div id="sampling" class="section level2">
<h2>Sampling</h2>
<p>A sampling function takes data and returns a sampled subset of the data. By default, <code>declare_sampling</code> understands arguments passed to <code>...</code> as <code>randomizr</code> arguments, but it’s easy to supply your own function instead.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_sampling &lt;-<span class="st"> </span><span class="kw">declare_sampling</span>(<span class="dt">n =</span> <span class="dv">250</span>)
smp &lt;-<span class="st"> </span><span class="kw">my_sampling</span>(pop_pos)
<span class="kw">nrow</span>(smp)</code></pre></div>
<pre><code>## [1] 250</code></pre>
</div>
<div id="assignment" class="section level2">
<h2>Assignment</h2>
<p>Assignment declarations return functions of data that return data. If you use the <code>randomizr</code> defaults, then it appends to the dataset an assignment draw and a vector of observed probability weights.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_assignment &lt;-<span class="st"> </span><span class="kw">declare_assignment</span>(<span class="dt">m =</span> <span class="dv">25</span>)
smp &lt;-<span class="st"> </span><span class="kw">my_assignment</span>(smp)
<span class="kw">table</span>(smp$Z)</code></pre></div>
<pre><code>## 
##   0   1 
## 225  25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(smp)</code></pre></div>
<pre><code>##      ID      income age Y_Z_0 Y_Z_1 S_inclusion_prob Z Z_cond_prob
## 4  0004  0.63286260  87     0  1.12             0.25 0         0.9
## 7  0007  1.51152200  68     0  0.93             0.25 0         0.9
## 8  0008 -0.09465904  83     0  1.08             0.25 1         0.1
## 14 0014 -0.27878877  70     0  0.95             0.25 1         0.1
## 17 0017 -0.28425292  33     0  0.58             0.25 1         0.1
## 20 0020  1.32011335  92     0  1.17             0.25 1         0.1</code></pre>
</div>
<div id="estimands" class="section level2">
<h2>Estimands</h2>
<p>Estimands run on data that includes potential outcomes, drawn earlier using a declare_potential_outcomes call.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_estimand &lt;-<span class="st"> </span><span class="kw">declare_estimand</span>(<span class="dt">ATE =</span> <span class="kw">mean</span>(Y_Z_1 -<span class="st"> </span>Y_Z_0))
<span class="kw">my_estimand</span>(pop_pos)</code></pre></div>
<pre><code>##   estimand_label estimand
## 1            ATE  0.81926</code></pre>
<p>The only part baked in to <code>DeclareDesign</code> is the naming structure, outcome_assignment_condition. You could write your own potential outcomes function to avoid this (and in most cases this would also require writing your own reveal_outcomes function).</p>
</div>
<div id="estimators" class="section level2">
<h2>Estimators</h2>
<p>To declare an estimator, you declare an estimator function, a difference_in_means by default. Optionally you also declare an estimand that is attached to the estimator.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">smp &lt;-<span class="st"> </span><span class="kw">reveal_outcomes</span>(smp)
my_estimator_dim &lt;-<span class="st"> </span><span class="kw">declare_estimator</span>(Y ~<span class="st"> </span>Z, <span class="dt">estimand =</span> my_estimand)
<span class="kw">my_estimator_dim</span>(smp)</code></pre></div>
<pre><code>##   estimator_label   est         se           p ci_lower ci_upper  df
## 1    my_estimator 0.822 0.04678319 1.92319e-45 0.729857 0.914143 248
##   estimand_label
## 1            ATE</code></pre>
<p>Using our simple <code>lm</code> function with built-in robust standard errors (HC2! or your choice of other HC’s) is similarly straightforward (it’s also fast! in RCPP!).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_estimator_lm &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">declare_estimator</span>(Y ~<span class="st"> </span>Z, 
                    <span class="dt">estimator_function =</span> estimatr::lm_robust_se, 
                    <span class="dt">coefficient_name =</span> <span class="st">&quot;Z&quot;</span>, 
                    <span class="dt">estimand =</span> my_estimand)

<span class="kw">my_estimator_lm</span>(smp)</code></pre></div>
<pre><code>##   estimator_label variable_names   est         se           p ci_lower
## 2    my_estimator              Z 0.822 0.04678319 1.92319e-45 0.729857
##   ci_upper estimand_label
## 2 0.914143            ATE</code></pre>
</div>
</div>
<div id="declaring-designs" class="section level1">
<h1>Declaring Designs</h1>
<p>Instead of defining your population, potential outcomes, and so on, you simply give us a set of functions in the order of your DAG, i.e. beginning with a population, then potential outcomes, sampling, and so on. You can also put any <code>R</code> function in causal order that takes data and returns data – including all the nice functions in <code>dplyr</code> like <code>mutate</code>, to allow you to create new variables and do things like collapse clusters</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">design &lt;-<span class="st"> </span><span class="kw">declare_design</span>(my_population,
                         my_potential_outcomes,
                         my_estimand,
                         dplyr::<span class="kw">mutate</span>(<span class="dt">big_income =</span> <span class="dv">5</span>*income), 
                         my_sampling,
                         my_assignment,
                         reveal_outcomes,
                         my_estimator_dim)</code></pre></div>
<p>Remarks re: <code>declare_design</code>:</p>
<ol style="list-style-type: decimal">
<li>The first argument must always be a dataset or create one.</li>
<li>Your estimand is placed where you want to define it, i.e. here we are defining a PATE by placing the estimand just after population and before sampling or assignment.</li>
<li><code>declare_design</code> produces two things: a “dgp function” and a “design function.” The dgp function draws a dataset and the design function returns an estimands dataframe and an estimates data frame. It simulates the design from population through estimates, in whatever order you tell it – meaning it carefully separates the data generating parts of the design and the calculation of estimates and estimands.</li>
</ol>
<p>You can run them directly via:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat &lt;-<span class="st"> </span><span class="kw">draw_data</span>(design)
<span class="kw">head</span>(dat)</code></pre></div>
<pre><code>##      ID     income age Y_Z_0 Y_Z_1 big_income S_inclusion_prob Z
## 1  0001  0.4593641  57  0.05  0.87  2.2968204             0.25 0
## 3  0003 -1.4463914  59  0.05  0.89 -7.2319569             0.25 0
## 10 0010  0.1161173  61  0.05  0.91  0.5805867             0.25 0
## 19 0019 -0.3130718  46  0.05  0.76 -1.5653592             0.25 0
## 24 0024 -0.5810718  33  0.05  0.63 -2.9053589             0.25 0
## 30 0030 -1.4011209  45  0.05  0.75 -7.0056043             0.25 0
##    Z_cond_prob    Y
## 1          0.9 0.05
## 3          0.9 0.05
## 10         0.9 0.05
## 19         0.9 0.05
## 24         0.9 0.05
## 30         0.9 0.05</code></pre>
<p>and</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_estimates</span>(design)</code></pre></div>
<pre><code>##   estimator_label   est         se            p  ci_lower  ci_upper  df
## 1    my_estimator 0.822 0.04767249 2.528631e-44 0.7281054 0.9158946 248
##   estimand_label
## 1            ATE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">get_estimands</span>(design)</code></pre></div>
<pre><code>##   estimand_label estimand
## 1            ATE  0.78985</code></pre>
</div>
<div id="custom-functions" class="section level1">
<h1>Custom functions</h1>
<p>Because all steps are functions, it’s easy for you to provide custom functions instead of using our defaults.</p>
<div id="custom-population" class="section level2">
<h2>Custom Population</h2>
<p>You can use a custom function to generate your population entirely on your own, too:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_population_function &lt;-<span class="st"> </span>function(N) {
  <span class="kw">data.frame</span>(<span class="dt">u =</span> <span class="kw">rnorm</span>(N))
}

my_population_custom &lt;-<span class="st"> </span><span class="kw">declare_population</span>(
  <span class="dt">population_function =</span> my_population_function, <span class="dt">N =</span> <span class="dv">100</span>)

pop_custom &lt;-<span class="st"> </span><span class="kw">my_population_custom</span>()

<span class="kw">head</span>(pop_custom)</code></pre></div>
<pre><code>##            u
## 1  1.6621024
## 2 -0.5557050
## 3 -1.1643612
## 4  0.1145226
## 5  1.9966502
## 6  0.8037155</code></pre>
</div>
<div id="custom-potential-outcomes" class="section level2">
<h2>Custom Potential Outcomes</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_potential_outcomes_function &lt;-
<span class="st">  </span>function(data) {
    data$Y_Z_0 &lt;-<span class="st"> </span><span class="kw">with</span>(data, u)
    data$Y_Z_1 &lt;-<span class="st"> </span><span class="kw">with</span>(data, <span class="fl">0.25</span> +<span class="st"> </span>u)
    data
  }
my_potential_outcomes_custom &lt;-<span class="st"> </span><span class="kw">declare_potential_outcomes</span>(
  <span class="dt">potential_outcomes_function =</span> my_potential_outcomes_function
)

pop_pos_custom &lt;-<span class="st"> </span><span class="kw">my_potential_outcomes_custom</span>(pop_custom)

<span class="kw">head</span>(pop_pos_custom[, <span class="kw">c</span>(<span class="st">&quot;u&quot;</span>, <span class="st">&quot;Y_Z_0&quot;</span>, <span class="st">&quot;Y_Z_1&quot;</span>)])</code></pre></div>
<pre><code>##            u      Y_Z_0      Y_Z_1
## 1  1.6621024  1.6621024  1.9121024
## 2 -0.5557050 -0.5557050 -0.3057050
## 3 -1.1643612 -1.1643612 -0.9143612
## 4  0.1145226  0.1145226  0.3645226
## 5  1.9966502  1.9966502  2.2466502
## 6  0.8037155  0.8037155  1.0537155</code></pre>
</div>
<div id="custom-sampling" class="section level2">
<h2>Custom Sampling</h2>
<p>Again, you can still use a totally separate custom sampling function easily. In this case, you are asked to provide a function that takes population data and returns sampled data, i.e. you draw the sample and then subset. You can also include inclusion weights if you wish in the function (as the default function does).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_sampling_function &lt;-<span class="st"> </span>function(data) {
     data$S &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(data),
            <span class="dt">size =</span> <span class="dv">1</span>,
            <span class="dt">prob =</span> <span class="fl">0.1</span>)
     data[data$S ==<span class="st"> </span><span class="dv">1</span>, ]
}

my_sampling_custom &lt;-<span class="st"> </span><span class="kw">declare_sampling</span>(
  <span class="dt">sampling_function =</span> my_sampling_function)

smp_custom &lt;-<span class="st"> </span><span class="kw">my_sampling_custom</span>(pop_pos)

<span class="kw">nrow</span>(smp_custom)</code></pre></div>
<pre><code>## [1] 105</code></pre>
</div>
<div id="custom-assignment" class="section level2">
<h2>Custom Assignment</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_assignment_function &lt;-<span class="st"> </span>function(data) {
  data$Z &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="kw">nrow</span>(data),
         <span class="dt">size =</span> <span class="dv">1</span>,
         <span class="dt">prob =</span> <span class="fl">0.5</span>)
  data
}
my_assignment_custom &lt;-<span class="st"> </span><span class="kw">declare_assignment</span>(
  <span class="dt">assignment_function =</span> my_assignment_function)

<span class="kw">table</span>(<span class="kw">my_assignment_custom</span>(pop_pos)$Z)</code></pre></div>
<pre><code>## 
##   0   1 
## 501 499</code></pre>
</div>
<div id="custom-estimand" class="section level2">
<h2>Custom Estimand</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_estimand_function &lt;-<span class="st"> </span>function(data) {
  <span class="kw">with</span>(data, <span class="kw">median</span>(Y_Z_1 -<span class="st"> </span>Y_Z_0))
}
my_estimand_custom &lt;-<span class="st"> </span><span class="kw">declare_estimand</span>(
  <span class="dt">estimand_function =</span> my_estimand_function, <span class="dt">label =</span> medianTE)

<span class="kw">my_estimand_custom</span>(pop_pos)</code></pre></div>
<pre><code>##   estimand_label estimand
## 1       medianTE     0.82</code></pre>
</div>
<div id="custom-estimator" class="section level2">
<h2>Custom Estimator</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_estimator_function &lt;-<span class="st"> </span>function(formula, data){
  <span class="kw">data.frame</span>(<span class="dt">est =</span> <span class="kw">with</span>(data, <span class="kw">mean</span>(Y)))
}

my_estimator_custom &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">declare_estimator</span>(Y ~<span class="st"> </span>Z, 
                    <span class="dt">estimator_function =</span> my_estimator_function, 
                    <span class="dt">estimand =</span> my_estimand)

<span class="kw">my_estimator_custom</span>(smp)</code></pre></div>
<pre><code>##   estimator_label    est estimand_label
## 1    my_estimator 0.0822            ATE</code></pre>
</div>
</div>
<div id="features" class="section level1">
<h1>Features</h1>
<div id="quick-design" class="section level2">
<h2>Quick design</h2>
<p>You can also write a design maker function that declares a design based on a set of parameters like N, the number of clusters, etc. and use the function <code>quick_design</code> to make designs using just those parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m_arm_trial &lt;-<span class="st"> </span>function(numb){
  my_population &lt;-<span class="st"> </span><span class="kw">declare_population</span>(
    <span class="dt">N =</span> numb, <span class="dt">income =</span> <span class="kw">rnorm</span>(N), <span class="dt">age =</span> <span class="kw">sample</span>(<span class="dv">18</span>:<span class="dv">95</span>, N, <span class="dt">replace =</span> T))

  my_potential_outcomes &lt;-<span class="st"> </span><span class="kw">declare_potential_outcomes</span>(
    <span class="dt">formula =</span> Y ~<span class="st"> </span>.<span class="dv">25</span> *<span class="st"> </span>Z +<span class="st"> </span>.<span class="dv">01</span> *<span class="st"> </span>age *<span class="st"> </span>Z)
  my_sampling &lt;-<span class="st"> </span><span class="kw">declare_sampling</span>(<span class="dt">n =</span> <span class="dv">250</span>)
  my_assignment &lt;-<span class="st"> </span><span class="kw">declare_assignment</span>(<span class="dt">m =</span> <span class="dv">25</span>)
  my_estimand &lt;-<span class="st"> </span><span class="kw">declare_estimand</span>(<span class="dt">ATE =</span> <span class="kw">mean</span>(Y_Z_1 -<span class="st"> </span>Y_Z_0))
  my_estimator_dim &lt;-<span class="st"> </span><span class="kw">declare_estimator</span>(Y ~<span class="st"> </span>Z, <span class="dt">estimand =</span> my_estimand)
  my_design &lt;-<span class="st"> </span><span class="kw">declare_design</span>(my_population,
                              my_potential_outcomes,
                              my_estimand,
                              my_sampling,
                              my_assignment,
                              reveal_outcomes,
                              my_estimator_dim)
  <span class="kw">return</span>(my_design)
}

my_1000_design &lt;-<span class="st"> </span><span class="kw">quick_design</span>(<span class="dt">template =</span> m_arm_trial, <span class="dt">numb =</span> <span class="dv">1000</span>)
<span class="kw">head</span>(<span class="kw">draw_data</span>(my_1000_design))</code></pre></div>
<pre><code>##      ID      income age Y_Z_0 Y_Z_1 S_inclusion_prob Z Z_cond_prob Y
## 1  0001 -0.28818473  63     0  0.88             0.25 0         0.9 0
## 7  0007  0.01710038  49     0  0.74             0.25 0         0.9 0
## 9  0009  2.71790043  19     0  0.44             0.25 0         0.9 0
## 15 0015  0.28570612  59     0  0.84             0.25 0         0.9 0
## 17 0017  1.55832326  78     0  1.03             0.25 0         0.9 0
## 18 0018  0.23281194  32     0  0.57             0.25 0         0.9 0</code></pre>
</div>
<div id="continuous-potential-outcomes" class="section level2">
<h2>Continuous potential outcomes</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_potential_outcomes_continuous &lt;-<span class="st"> </span><span class="kw">declare_potential_outcomes</span>(
  <span class="dt">formula =</span> Y ~<span class="st"> </span>.<span class="dv">25</span> *<span class="st"> </span>Z +<span class="st"> </span>.<span class="dv">01</span> *<span class="st"> </span>age *<span class="st"> </span>Z, <span class="dt">condition_names =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> .<span class="dv">1</span>))

continuous_treatment_function &lt;-<span class="st"> </span>function(data){
 data$Z &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> .<span class="dv">1</span>), <span class="dt">size =</span> <span class="kw">nrow</span>(data), <span class="dt">replace =</span> <span class="ot">TRUE</span>)
 data
}

my_assignment_continuous &lt;-<span class="st"> </span><span class="kw">declare_assignment</span>(<span class="dt">assignment_function =</span> continuous_treatment_function)

my_design &lt;-<span class="st"> </span><span class="kw">declare_design</span>(<span class="kw">my_population</span>(),
                            my_potential_outcomes_continuous,
                            my_assignment_continuous,
                            reveal_outcomes)

<span class="kw">head</span>(<span class="kw">draw_data</span>(my_design))</code></pre></div>
<pre><code>##     ID    income age Y_Z_0 Y_Z_0.1 Y_Z_0.2 Y_Z_0.3 Y_Z_0.4 Y_Z_0.5 Y_Z_0.6
## 1 0001 1.1543236  68     0   0.093   0.186   0.279   0.372   0.465   0.558
## 2 0002 0.3877885  86     0   0.111   0.222   0.333   0.444   0.555   0.666
## 3 0003 0.6217400  34     0   0.059   0.118   0.177   0.236   0.295   0.354
## 4 0004 2.3430092  82     0   0.107   0.214   0.321   0.428   0.535   0.642
## 5 0005 0.6073704  48     0   0.073   0.146   0.219   0.292   0.365   0.438
## 6 0006 0.8070361  19     0   0.044   0.088   0.132   0.176   0.220   0.264
##   Y_Z_0.7 Y_Z_0.8 Y_Z_0.9 Y_Z_1   Z     Y
## 1   0.651   0.744   0.837  0.93 0.2 0.186
## 2   0.777   0.888   0.999  1.11 0.6 0.666
## 3   0.413   0.472   0.531  0.59 0.4 0.236
## 4   0.749   0.856   0.963  1.07 0.4 0.428
## 5   0.511   0.584   0.657  0.73 0.6 0.438
## 6   0.308   0.352   0.396  0.44 0.1 0.044</code></pre>
</div>
<div id="attrition" class="section level2">
<h2>Attrition</h2>
<p>Just another potential outcome!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_potential_outcomes_attrition &lt;-<span class="st"> </span><span class="kw">declare_potential_outcomes</span>(
  <span class="dt">formula =</span> R ~<span class="st"> </span><span class="kw">rbinom</span>(<span class="dt">n =</span> N, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="kw">pnorm</span>(Y_Z_0)))

my_design &lt;-<span class="st"> </span><span class="kw">declare_design</span>(<span class="kw">my_population</span>(),
                            my_potential_outcomes,
                            my_potential_outcomes_attrition,
                            my_assignment,
                            <span class="kw">reveal_outcomes</span>(<span class="dt">outcome_variable_name =</span> <span class="st">&quot;R&quot;</span>),
                            <span class="kw">reveal_outcomes</span>(<span class="dt">attrition_variable_name =</span> <span class="st">&quot;R&quot;</span>))

<span class="kw">head</span>(<span class="kw">draw_data</span>(my_design)[, <span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;Y_Z_0&quot;</span>, <span class="st">&quot;Y_Z_1&quot;</span>, <span class="st">&quot;R_Z_0&quot;</span>, <span class="st">&quot;R_Z_1&quot;</span>, <span class="st">&quot;Z&quot;</span>, <span class="st">&quot;R&quot;</span>, <span class="st">&quot;Y&quot;</span>)])</code></pre></div>
<pre><code>##     ID Y_Z_0 Y_Z_1 R_Z_0 R_Z_1 Z R    Y
## 1 0001  0.05  0.52     0     1 0 0   NA
## 2 0002  0.05  0.48     1     0 0 1 0.05
## 3 0003  0.05  0.49     0     1 0 0   NA
## 4 0004  0.05  0.57     1     1 0 1 0.05
## 5 0005  0.05  1.04     1     0 0 1 0.05
## 6 0006  0.05  0.78     0     1 0 0   NA</code></pre>
</div>
<div id="stochastic-population-sizes" class="section level2">
<h2>Stochastic population sizes</h2>
<p>The population (or any level of the population) can have stochastic population sizes. (In fact, N can be a number, a fixed vector of numbers, or an expression that returns a stochastic number or vector of numbers.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stochastic_population &lt;-<span class="st"> </span><span class="kw">declare_population</span>(
  <span class="dt">N =</span> <span class="kw">sample</span>(<span class="dv">500</span>:<span class="dv">1000</span>, <span class="dv">1</span>), <span class="dt">income =</span> <span class="kw">rnorm</span>(N), <span class="dt">age =</span> <span class="kw">sample</span>(<span class="dv">18</span>:<span class="dv">95</span>, N, <span class="dt">replace =</span> <span class="ot">TRUE</span>))

<span class="kw">c</span>(<span class="kw">nrow</span>(<span class="kw">stochastic_population</span>()), 
  <span class="kw">nrow</span>(<span class="kw">stochastic_population</span>()), 
  <span class="kw">nrow</span>(<span class="kw">stochastic_population</span>()))</code></pre></div>
<pre><code>## [1] 658 691 788</code></pre>
</div>
</div>
<div id="three-companion-packages" class="section level1">
<h1>Three companion packages</h1>
<p>All built-in default functions are in three standalone packages that can be used to support DeclareDesign or on their own. This enables the simplicity of the six key functions in <code>declare_design</code> and a minimal number of dependencies.</p>
<p>For now, make sure you have the development versions of each package from Github, not the version of randomizr on CRAN.</p>
<p>The three packages are:</p>
<div id="fabricatr" class="section level2">
<h2><code>fabricatr</code></h2>
<p><code>fabricatr</code>, includes data creation features described above. It’s main function, <code>fabricate_data</code>, creates simulated data as in the above examples in <code>declare_population</code>. It can do single level data creation or multilevel creation using <code>level()</code> within <code>fabricate_data</code>. As it turns out, it is also the backbone of <code>declare_potential_outcomes</code> default function that creates each PO as an expression described above (i.e. where you define <code>Y_Z_1 = 0.5 + Z</code>). The second main function is <code>bootstrap_data</code> which resamples your data in a way that respects hierarchy. We expect this package will be built up further, including with proportional outcomes functions.</p>
</div>
<div id="randomizr" class="section level2">
<h2><code>randomizr</code></h2>
<p><code>randomizr</code> works by default as described above in <code>declare_assignment()</code> – in fact appears to the user similarly to the old version – but is entirely separate now. The set of sampling functions that mimic the assignment functions are now also built in to <code>randomizr</code>, including simple, clustered, stratified, and clustered-and-stratified sampling. The next step is to rewrite some of these into C++ to see if we can speed a few of them up. Based on our understanding of Rcpp, the speedup gains here may be minor.</p>
</div>
<div id="estimatr" class="section level2">
<h2><code>estimatr</code></h2>
<p>The <code>C++</code> version of lm with robust standard errors described above as well as the difference-in-means and blocked difference-in-means functions are the core of <code>estimatr</code> now, but it can be built up with further fast estimators.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
